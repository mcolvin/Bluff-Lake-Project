---
title: "Combined Analysis"
author: "V. Starnes"
date: "April 23, 2020"
output:
  word_document: default
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE, echo=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

##Linking Water Surface Elevation and Lake Volume

Bathymetric data for Bluff Lake was collected in the winter of 2019 and 2020. Transect data was extrapolated to the whole reservoir and converted to a point layer of elevations in Arc GIS. In this section we link different WCS board heights and corresponding water surface elevation to water volume. Board elevations were supplied by the USFWS.First, all the points in the bathymetric data less than a given board hight are selected. Then those elevations are subtracted from the water surface elevation to give depths. Lastly, the depths are multiplied by the area surrounding each point to yeild volume. Then lake volume can be plotted against lake elevation and predictive models can be fit.

```{r Linking WSE to Volume, echo=FALSE}
dat <- read.csv("~/GitHub/Bluff-Lake-Project/_analysis/Depth-Mapping/_dat/Bathymetry/WCS_BTTMUP_2_2.csv")
library(scales)
library(mgcv)
library(lubridate)
library(dplyr)
library(tidyverse)
library(zoo)
library(data.table)
library(tidyverse)
library(plyr)
library(car)
library(ggplot2)
library(grid)

# ---- Lake Volume
# one point=6.25m^2
Z <- c(dat$POINT_Z < (66.45402+0))
Z <- c((66.45402+0-Z))
Z <- Z*1.56
Z <- sum(Z)
B <- c(dat$POINT_Z < (66.45402+.22))
B <- c((66.45402+.22-B))
B <- B*1.56
B <- sum(B) #convert to volume
BB <- c(dat$POINT_Z < (66.45402+.44)) #add board hight and required depth
BB <- c((66.45402+.44-BB))
BB <- BB*1.56
BB <- sum(BB)
BBB <- c(dat$POINT_Z < (66.45402+.66)) #add board hight and required depth
BBB <- c((66.45402+.66-BBB))
BBB <- BBB*1.56
BBB <- sum(BBB)
BBBB <- c(dat$POINT_Z < (66.45402+.88)) #add board hight and required depth
BBBB <- c((66.45402+.88-BBBB))
BBBB <- BBBB*1.56
BBBB <- sum(BBBB)
BBBBB <- c(dat$POINT_Z < (66.45402+1.1)) #add board hight and required depth
BBBBB <- c((66.45402+1.1-BBBBB))
BBBBB <- BBBBB*1.56
BBBBB <- sum(BBBBB)
BBBBBB <- c(dat$POINT_Z < (66.45402+1.32)) #add board hight and required depth
BBBBBB <- c((66.45402+1.32-BBBBBB))
BBBBBB <- BBBBBB*1.56
BBBBBB <- sum(BBBBBB)
BBBBBBB <- c(dat$POINT_Z < (66.45402+1.54)) #add board hight and required depth
BBBBBBB <- c((66.45402+1.54-BBBBBBB))
BBBBBBB <- BBBBBBB*1.56
BBBBBBB <- sum(BBBBBBB)
BBBBBBBB <- c(dat$POINT_Z < (66.45402+1.76)) #add board hight and required depth
BBBBBBBB <- c((66.45402+1.76-BBBBBBBB))
BBBBBBBB <- BBBBBBBB*1.56
BBBBBBBB <- sum(BBBBBBBB)
BBBBBBBBB <- c(dat$POINT_Z < (66.45402+1.98)) #add board hight and required depth
BBBBBBBBB <- c((66.45402+1.98-BBBBBBBBB))
BBBBBBBBB <- BBBBBBBBB*1.56
BBBBBBBBB <- sum(BBBBBBBBB)
elevation <- c(66.45402, 66.67402, 66.89402, 67.11402, 67.33402,
               67.55402, 67.77402, 67.99402, 68.21402, 68.43402)
volume <- c(Z, B, BB, BBB, BBBB, BBBBB, BBBBBB, BBBBBBB, BBBBBBBB, BBBBBBBBB)
plot(elevation, volume, xlab="Water Surface Elevation", ylab="Volume (m^3)", main = "Bluff Lake Volume", type="l", col="red", ylim=c(100500000,102000000), xlim=c(66.5,68.5))
gam_1 <- gam(volume ~ s(elevation, bs = "cr"),
             family = gaussian)
summary(gam_1)
gam_2 <- gam(elevation ~ s(volume, bs = "cr"),
             family = gaussian)
summary(gam_2)
par(new=T)
plot(gam_1$fitted.values~elevation, ylim=c(100500000,102000000), xlim=c(66.5,68.5), col="blue", type="l", xlab=NA, ylab=NA)
```

##Lake Level Dynamics

Two water level loggers set to record every 15 minutes were deployed within Bluff Lake.The logger located at the Cypress Boardwalk contained the most consistant an uninterupted data, so this logger was selected for use in analysis. In this section logger data is plotted with upstream discharge data collected from the Macon USGS gauge.

```{r lake, echo=FALSE}
par(mfrow=c(1,1))
dat2<- read.csv("~/GitHub/Bluff-Lake-Project/_analysis/Depth-Mapping/_dat/DischargeDataMacon15min.csv")
dat2$Date.Time <- as.POSIXct(dat2$Date.Time, format="%m/%d/%Y %H:%M")
dat2$month<- lubridate::month(as.POSIXct(dat2$Date.Time, format="%Y/%m/%d %H:%M"), label= T)
Elevation <- read.csv("~/GitHub/Bluff-Lake-Project/_analysis/Depth-Mapping/_dat/Level_loggersEL.csv")
Elevation <- subset(Elevation, Elevation$ï..Location == "Cypress")
Elevation$Date.Time <- (as.POSIXct(Elevation$Date.Time, format="%m/%d/%Y %H:%M"))
Elevation$month<- lubridate::month(as.POSIXct(Elevation$Date.Time, format="%Y/%m/%d %H:%M"), label= T)
Elevation$WSElevation<-rescale(Elevation$WSElevation, to=c(0,1))
dat2$ï..CFS<-rescale(dat2$ï..CFS, to=c(0,1))


#May
dat2May<-subset(dat2, dat2$month=="May")
plot(dat2May$ï..CFS~dat2May$Date.Time, main="May 2019",type='l',col="red", ylab="")
ElevationMay<-subset(Elevation, Elevation$month=="May")
par(new=TRUE)
ElevationMay<-ElevationMay[order(ElevationMay$Date.Time),]
plot(WSElevation~Date.Time,ElevationMay, type="l", 
     xaxt = "n", yaxt = "n", ylab = "", xlab = "")
legend("topright", c("Discharge", "Lake Elevation"),
       col = c("red", "black"), lty = c(1, 1))
#June
dat2Jun<-subset(dat2, dat2$month=="Jun")
plot(dat2Jun$ï..CFS~dat2Jun$Date.Time, main="June 2019",type='l',col="red", ylab="" )
ElevationJun<-subset(Elevation, Elevation$month=="Jun")
par(new=TRUE)
ElevationJun<-ElevationJun[order(ElevationJun$Date.Time),]
plot(WSElevation~Date.Time,ElevationJun, type="l", 
     xaxt = "n", yaxt = "n", ylab = "", xlab = "")
legend("topright", c("Discharge", "Lake Elevation"),
       col = c("red", "black"), lty = c(1, 1))
#July
dat2Jul<-subset(dat2, dat2$month=="Jul")
  plot(dat2Jul$ï..CFS~dat2Jul$Date.Time, main="July 2019",type='l',col="red", ylab="")
ElevationJul<-subset(Elevation, Elevation$month=="Jul")
par(new=TRUE)
ElevationJul<-ElevationJul[order(ElevationJul$Date.Time),]
plot(WSElevation~Date.Time,ElevationJul, type="l", 
     xaxt = "n", yaxt = "n", ylab = "", xlab = "")
legend("topleft", c("Discharge", "Lake Elevation"),
       col = c("red", "black"), lty = c(1, 1))
#August
dat2Aug<-subset(dat2, dat2$month=="Aug")
plot(dat2Aug$ï..CFS~dat2Aug$Date.Time, main="August 2019",type='l',col="red", xaxt = "n", yaxt = "n", ylab = "", xlab = "")
ElevationAug<-subset(Elevation, Elevation$month=="Aug")
par(new=TRUE)
ElevationAug<-ElevationAug[order(ElevationAug$Date.Time),]
plot(WSElevation~Date.Time,ElevationAug, type="l", ylab="")
legend("topleft", c("Discharge", "Lake Elevation"),
       col = c("red", "black"), lty = c(1, 1))
#September
dat2Sep<-subset(dat2, dat2$month=="Sep")
plot(dat2Sep$ï..CFS~dat2Sep$Date.Time, main="September 2019",type='l',col="red", xaxt = "n", yaxt = "n", ylab = "", xlab = "")
ElevationSep<-subset(Elevation, Elevation$month=="Sep")
par(new=TRUE)
ElevationSep<-ElevationSep[order(ElevationSep$Date.Time),]
plot(WSElevation~Date.Time,ElevationSep, type="l", ylab="")
legend("topright", c("Discharge", "Lake Elevation"),
       col = c("red", "black"), lty = c(1, 1))
#October
dat2Oct<-subset(dat2, dat2$month=="Oct")
  plot(dat2Oct$ï..CFS~dat2Oct$Date.Time , main="October 2019",type='l',col="red", ylab="")
ElevationOct<-subset(Elevation, Elevation$month=="Oct")
par(new=TRUE)
ElevationOct<-ElevationOct[order(ElevationOct$Date.Time),]
plot(WSElevation~Date.Time,ElevationOct, type="l", 
     xaxt = "n", yaxt = "n", ylab = "", xlab = "")
legend("topleft", c("Discharge", "Lake Elevation"),
       col = c("red", "black"), lty = c(1, 1))
#November
dat2Nov<-subset(dat2, dat2$month=="Nov")
plot(dat2Nov$ï..CFS~dat2Nov$Date.Time, main="November 2019",type='l',col="red", ylab="")
ElevationNov<-subset(Elevation, Elevation$month=="Nov")
par(new=TRUE)
ElevationNov<-ElevationNov[order(ElevationNov$Date.Time),]
plot(WSElevation~Date.Time,ElevationNov, type="l", 
     xaxt = "n", yaxt = "n", ylab = "", xlab = "")
legend("topright", c("Discharge", "Lake Elevation"),
       col = c("red", "black"), lty = c(1, 1))
#DECEMBER
dat2Dec<-subset(dat2, dat2$month=="Dec")
plot(dat2Dec$ï..CFS~dat2Dec$Date.Time, main="December 2019",type='l',col="red", ylab="")
ElevationDec<-subset(Elevation, Elevation$month=="Dec")
par(new=TRUE)
ElevationDec<-ElevationDec[order(ElevationDec$Date.Time),]
plot(WSElevation~Date.Time,ElevationDec, type="l", 
     xaxt = "n", yaxt = "n", ylab = "", xlab = "")
legend("topleft", c("Discharge", "Lake Elevation"),
       col = c("red", "black"), lty = c(1, 1))

dat2Jan<-subset(dat2, dat2$month=="Jan")
plot(dat2Jan$ï..CFS~dat2Jan$Date.Time, type='l',col="red", ylab="")
ElevationJan<-subset(Elevation, Elevation$month=="Jan")
par(new=TRUE)
ElevationJan<-ElevationJan[order(ElevationJan$Date.Time),]
plot(WSElevation~Date.Time,ElevationJan, main="January 2020",type="l", 
     xaxt = "n", yaxt = "n", ylab = "", xlab = "")
legend("topright", c("Discharge", "Lake Elevation"),
       col = c("red", "black"), lty = c(1, 1))
```

##Predict WSE given Discharge

Macon gauge data was collected every 30 minutes. Water level data within Bluff Lake was recorded t 15 minute intervals. To match time recordings, Lake level logger readings were averaged every 30 minutes. A generalized addative model was then used to predict lake elevation given discharge. The actual and predicted values were then plotted together.

```{r Pred-WSE, echo=FALSE}
#Links between water surface elevation and Macon gauge discharge
par(mfrow=c(1,1))

dat2<- read.csv("~/GitHub/Bluff-Lake-Project/_analysis/Depth-Mapping/_dat/DischargeDataMacon15min.csv")
dat2$Date.Time <- as.POSIXct(dat2$Date.Time, format="%m/%d/%Y %H:%M")
dat2$month<- lubridate::month(as.POSIXct(dat2$Date.Time, format="%Y/%m/%d %H:%M"), label = F)
dat2$Date.Time<-round_date(dat2$Date.Time, "30 mins")
CMS<-ddply(dat2, c("Date.Time","month"), summarize,
           meanCMS=mean(ï..CFS))

Elevation <- read.csv("~/GitHub/Bluff-Lake-Project/_analysis/Depth-Mapping/_dat/Level_loggersEL.csv")
Elevation <- subset(Elevation, Elevation$ï..Location == "Cypress")
Elevation$Date.Time <- (as.POSIXct(Elevation$Date.Time, format="%m/%d/%Y %H:%M"))
Elevation$month<- lubridate::month(as.POSIXct(Elevation$Date.Time, format="%Y/%m/%d %H:%M"), label= F)
data<-merge(Elevation, CMS)
#try GAM


matrix_gam <- data.table(Ele = data$WSElevation,
                         CMS = data$meanCMS,
                         Month = data$month)

gam_4 <- gam(Ele ~ te(CMS, Month,
                       k = c(48, 8),
                       bs = c("cr", "ps")),
             data = matrix_gam,
             family = gaussian)
summary(gam_4)
summary(gam_4)$s.table

data$FitG4<- gam_4$fitted.values
plot(FitG4~Date.Time, data, type="l", col="red", ylim=c(68.6,69.8), 
     main="GAM Model 4", xlab="Date", ylab="Water Surface Elevation")
par(new=T)
plot(WSElevation~Date.Time, data, type="l", col="blue", ylim=c(68.6,69.8),ylab=NA, xlab=NA)
legend("topleft", c("Predicted", "Lake Elevation"),
       col = c("red", "black"), lty = c(1, 1))
```

##Predict Change in Volume given Discharge 

In this section we take the above fit a step further by attempting to predict change in lake volume given changes in discharge. Discharge and Elevation data were averaged for each day. Then, differences between days for both Discharge and Elevation were obtained. Lake elevations were converted to volumes using the gam_1 model from section one. The data was then split based on positive or negative discharge. Seperate GAM models were fit to alternate discharges. The actual and predicted lake volumes were then plotted against discharge for both models. Then, using the new models, lake volume was predicted for all available gauge data spanning 1945-2020.

```{r Pred-Volume, echo=FALSE}

 dat<- read.csv("~/GitHub/Bluff-Lake-Project/_analysis/Depth-Mapping/_dat/DailyMacon01011945_01012020.csv")
 dat$ï..datetime <- as.POSIXct(dat$ï..datetime, format="%m/%d/%Y")
 names(dat)[1]<-"Date"
 #add in missing dates
 Date<-seq(as.Date("1945/1/1"), as.Date("2019/12/31"), "days")
 Date<-as.data.frame(Date)
 Date$Date<-as.POSIXct(Date$Date, format="%Y/%m/%d")
 Date$Date<-round_date(Date$Date, "day")

 dat<-left_join(Date, dat, by = "Date")
  dat$year<-lubridate::year(dat$Date)
  
  dat<- dat %>% 
  group_by(year) %>% 
    filter(!is.na(Discharge_cfs))
 #dat$Discharge_cfs<-na.approx(dat$Discharge_cfs)
 dat$Discharge_cms<-dat$Discharge_cfs*0.028316847

 dat$month<- lubridate::month(as.POSIXct(dat$Date, format="%Y/%m/%d"), label = T)
 dat$year<-lubridate::year(dat$Date)
 dat$day<-lubridate::day(dat$Date)
 dat$DeltaCMS<-c(NA,diff(dat$Discharge_cms))
 dat$meanCMS<-dat$Discharge_cms

 dat2<- read.csv("~/GitHub/Bluff-Lake-Project/_analysis/Depth-Mapping/_dat/DischargeDataMacon15min.csv")
 dat2$Date.Time <- as.POSIXct(dat2$Date.Time, format="%m/%d/%Y %H:%M")
 dat2$month<- lubridate::month(as.POSIXct(dat2$Date.Time, format="%Y/%m/%d %H:%M"), label = T)
 dat2$Date.Time<-round_date(dat2$Date.Time, "30 mins")
 CMS<-ddply(dat2, c("Date.Time","month"), summarize,
            meanCMS=mean(ï..CFS))
 Elevation <- read.csv("~/GitHub/Bluff-Lake-Project/_analysis/Depth-Mapping/_dat/Level_loggersEL.csv")
 Elevation <- subset(Elevation, Elevation$ï..Location == "Cypress")
 Elevation$Date.Time <- (as.POSIXct(Elevation$Date.Time, format="%m/%d/%Y %H:%M"))
 Elevation$month<- lubridate::month(as.POSIXct(Elevation$Date.Time, format="%Y/%m/%d %H:%M"), label= T)
 data<-merge(Elevation, CMS)

# #try GAM
 #group data by day
 data$Date.Time<-round_date(data$Date.Time, "day")
 data<-data %>% dplyr::group_by(data$Date.Time) %>%
   dplyr::summarize(meanCMS=mean(meanCMS),
                    WSElevation=mean(WSElevation))
 data2<-data

 #differce between days elevation
 data2$DeltaEle<-c(NA, diff(data2$WSElevation))
 #convert Elevation to volume
 data2$elevation<-data2$WSElevation
 data2$Vol<- predict(gam_1, data2)
  #change in volume
 data2$DeltaVol<-c(NA,diff(data2$Vol))
 #difference between days CMS
 data2$DeltaCMS<-c(NA,diff(data2$meanCMS))
 #add month back
 data2$Date.Time<-data2$`data$Date.Time`
 data2$month<- lubridate::month(as.POSIXct(data2$Date.Time, format="%m/%d/%Y"), label= T)
# #Get rid of Negatives
 data4<-data2
 data4 <- filter(data4, DeltaVol>0)
 data4 <- filter(data4, DeltaCMS>0)
 Posgam <- gam(DeltaVol ~ s(meanCMS),
               data = data4,
               family = gaussian)
 summary(Posgam)
 data5<-data2
 data5 <- filter(data5, DeltaVol<0)
 data5 <- filter(data5, DeltaCMS<0)
 Neggam <- gam(DeltaVol ~ s(meanCMS),
               data = data5,
               family = gaussian)
summary(Neggam)
 data5<-data2
 data5 <- filter(data5, DeltaVol<0)
 data5 <- filter(data5, DeltaCMS<0)
 Neggam <- gam(DeltaVol ~ s(meanCMS),
               data = data5,
               family = gaussian)
summary(Neggam)
#Plots
plot(DeltaVol~meanCMS, data4, col="blue", main="Change in Lake Volume vs Discharge")
par(new=T)
plot(Posgam$fitted.values~data4$meanCMS, col="red", ylab=NA, xlab=NA, ylim=c(min(data4$DeltaVol), max(data4$DeltaVol)))
legend("topleft", c("Predicted", "Actual"),
       col = c("red", "blue"), lty = c(1, 1))
plot(DeltaVol~meanCMS, data5, col="blue", main="Change in Lake Volume vs Discharge")
par(new=T)
plot(Neggam$fitted.values~data5$meanCMS, col="red", ylab=NA, xlab=NA, ylim=c(min(data5$DeltaVol), max(data5$DeltaVol)))
legend("bottomleft", c("Predicted", "Actual"),
       col = c("red", "blue"), pch = c(1, 1))
####Now use GAM to predict change in volume given discharge
datP <- filter(dat, DeltaCMS>0)
datP$DeltaVol<-predict(Posgam, datP)
datN <- filter(dat, DeltaCMS<0)
datN$DeltaVol<-predict(Neggam, datN)
data<-rbind(datN, datP)
names(data)[1]<-"Date"

write.csv(data, "~/GitHub/Bluff-Lake-Project/_analysis/Depth-Mapping/_dat/PADDLE_DISCHARGE22.csv")

```

##Simulate Lake Level

We then combined predictions of daily lake volume change with different board elevations and discharge strategies to simulate monthly water level variations. A starting water volume was assigned at the beginning of every month. This volumes corresponds to the lake elevation for varying numbers of boards in the water control structure. Then paddlefish dicharges were subtracted weekly on the 1, 7, 14, 21, and 28 of each month. Variable starting lake level elevation as well as differing combinations of paddlefish discharges can be used to look at different management scenarios.

#This section should be re-run for variable starting elevation and discharge combinations.


```{r Paddlefish, echo=FALSE}
fish=read.csv("~/GitHub/Bluff-Lake-Project/_analysis/Depth-Mapping/_dat/PADDLE_DISCHARGE22.csv")

fish$Date<-as.POSIXct(strptime(as.character(fish$Date),"%Y-%m-%d"))
fish$month<-as.numeric(format(fish$Date, "%m"))
fish$year<-as.numeric(format(fish$Date, "%Y"))
str(fish)
fish<-fish %>% mutate(Date=ymd(Date)) #make this the proper format
str(fish)

a=fish %>% dplyr::group_by(year, month) %>% dplyr::summarise(Date=max(Date)) #get the max date for each month-year

fish2=data.frame()#create an empty data frame

for(i in 1:nrow(a)){
  b=data.frame(Date=seq(ymd(paste(a$year[i], a$month[i], "01", sep="-")), a$Date[i], 1))
  fish2=rbind(fish2, b)
} #makes sure there is each day in each month in each year


fish3=left_join(fish2, fish) 
#interpolate missing values
fish3$DeltaVol<-na.spline(fish3$DeltaVol)
fish3$Date2<-as.POSIXct(strptime(as.character(fish3$Date),"%Y-%m-%d"))
fish3$month<-as.numeric(format(fish3$Date2, "%m"))
fish3$year<-as.numeric(format(fish3$Date2, "%Y"))
fish3$day<-as.numeric(format(fish3$Date2, "%d"))

fish3=mutate(fish3, fishD=ifelse(day==1|day==7|day==14|day==21|day==28, 488160, 0)) #for the 1st and 15th create the discharges
#Run different discharges: 0, 81360, 162720, 244080, 325440, 406800, 488160


## COMBINE YEAR AND MONTH TO LOOP OVER 
fish3$yr_month<-paste(fish3$year,fish3$month,sep="-")
fish3<-fish3[order(fish3$Date2),]
## YEAR MONTH COMBINATIONS TO LOOP OVER
combos<-unique(fish3$yr_month)
combos<- combos[-length(combos)]## DROP 2020-01 ONLY 1 DAY THERE

fish3$volume<-NA  ## KEEP TRACK OF VOLUME THAT CHANGES DAILY AS VOL[PREV DAY] + IN - OUT
for(i in 1:length(combos))
    {
    indx<-which(fish3$yr_month==combos[i]) # ROW INDICES FOR THE YEAR MONTH COMBINATION SHOULD BE A VECTOR OF ~ 30 VALUES
    ## FIRST DAY
    first_day_row_indx<- indx[1]
    fish3$volume[first_day_row_indx]<-101976480
    ## INITIAL VOLUME AT THE FIRST OF THE MONTH-
    #100447697 100762656 101047557 101227827 101257957 
    #101294378 101377521 101514389 101703873 101976480
    ## LOOP OVER REMAINING DAYS IN THE MONTH
    for(j in 2:length(indx))
        {
        current_day<- indx[j]
        day_before<- indx[j-1]
        fish3$volume[current_day]<- fish3$volume[day_before]+fish3$DeltaVol[current_day]-fish3$fishD[current_day]
        }
    }

write.csv(fish3, "~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_16.95cms_discharge/9Boards.csv")

theme_set(theme_classic())

Jan<-subset(fish3, month==1)
ggplot(Jan, aes(day, volume, group = year, color = year)) + 
  geom_line( )+
  labs(title="January Time Series of Lake Volume", 
       y="Volume m^3",
       x="Day of Month"
       ) +
  ylim(99000000, 103500000)+
  geom_hline(yintercept=101976479)+
  geom_hline(yintercept=101703873)+
  geom_hline(yintercept=101514389)+
  geom_hline(yintercept=101377521)+
  geom_hline(yintercept=101294378)+
  geom_hline(yintercept=101257987)+
  geom_hline(yintercept=101227827)+
  geom_hline(yintercept=101047557)+
  geom_hline(yintercept=100762655)+
  geom_hline(yintercept=100447696, col="red")
  


Feb<-subset(fish3, month==2)
ggplot(Feb, aes(day, volume, group = year, color = year)) + 
  geom_line( )+
  labs(title="February Time Series of Lake Volume", 
       y="Volume m^3",
       x="Day of Month"
  ) +
  ylim(99000000, 103500000)+
  geom_hline(yintercept=101976479)+
  geom_hline(yintercept=101703873)+
  geom_hline(yintercept=101514389)+
  geom_hline(yintercept=101377521)+
  geom_hline(yintercept=101294378)+
  geom_hline(yintercept=101257987)+
  geom_hline(yintercept=101227827)+
  geom_hline(yintercept=101047557)+
  geom_hline(yintercept=100762655)+
  geom_hline(yintercept=100447696, col="red")

Mar<-subset(fish3, month==3)
ggplot(Mar, aes(day, volume, group = year, color = year)) + 
  geom_line( )+
  labs(title="March Time Series of Lake Volume", 
       y="Volume m^3",
       x="Day of Month"
  ) +
  ylim(99000000, 103500000)+
  geom_hline(yintercept=101976479)+
  geom_hline(yintercept=101703873)+
  geom_hline(yintercept=101514389)+
  geom_hline(yintercept=101377521)+
  geom_hline(yintercept=101294378)+
  geom_hline(yintercept=101257987)+
  geom_hline(yintercept=101227827)+
  geom_hline(yintercept=101047557)+
  geom_hline(yintercept=100762655)+
  geom_hline(yintercept=100447696, col="red")

Apr<-subset(fish3, month==4)
ggplot(Apr, aes(day, volume, group = year, color = year)) + 
  geom_line( )+
  labs(title="April Time Series of Lake Volume", 
       y="Volume m^3",
       x="Day of Month"
  ) +
  ylim(99000000, 103500000)+
  geom_hline(yintercept=101976479)+
  geom_hline(yintercept=101703873)+
  geom_hline(yintercept=101514389)+
  geom_hline(yintercept=101377521)+
  geom_hline(yintercept=101294378)+
  geom_hline(yintercept=101257987)+
  geom_hline(yintercept=101227827)+
  geom_hline(yintercept=101047557)+
  geom_hline(yintercept=100762655)+
  geom_hline(yintercept=100447696, col="red")

May<-subset(fish3, month==5)
ggplot(May, aes(day, volume, group = year, color = year)) + 
  geom_line( )+
  labs(title="May Time Series of Lake Volume", 
       y="Volume m^3",
       x="Day of Month"
  ) +
  ylim(99000000, 103500000)+
  geom_hline(yintercept=101976479)+
  geom_hline(yintercept=101703873)+
  geom_hline(yintercept=101514389)+
  geom_hline(yintercept=101377521)+
  geom_hline(yintercept=101294378)+
  geom_hline(yintercept=101257987)+
  geom_hline(yintercept=101227827)+
  geom_hline(yintercept=101047557)+
  geom_hline(yintercept=100762655)+
  geom_hline(yintercept=100447696, col="red")

Jun<-subset(fish3, month==6)
ggplot(Jun, aes(day, volume, group = year, color = year)) + 
  geom_line( )+
  labs(title="June Time Series of Lake Volume", 
       y="Volume m^3",
       x="Day of Month"
  ) +
  ylim(99000000, 103500000)+
  geom_hline(yintercept=101976479)+
  geom_hline(yintercept=101703873)+
  geom_hline(yintercept=101514389)+
  geom_hline(yintercept=101377521)+
  geom_hline(yintercept=101294378)+
  geom_hline(yintercept=101257987)+
  geom_hline(yintercept=101227827)+
  geom_hline(yintercept=101047557)+
  geom_hline(yintercept=100762655)+
  geom_hline(yintercept=100447696, col="red")

Jul<-subset(fish3, month==7)
ggplot(Jul, aes(day, volume, group = year, color = year)) + 
  geom_line( )+
  labs(title="July Time Series of Lake Volume", 
       y="Volume m^3",
       x="Day of Month"
  ) +
  ylim(99000000, 103500000)+
  geom_hline(yintercept=101976479)+
  geom_hline(yintercept=101703873)+
  geom_hline(yintercept=101514389)+
  geom_hline(yintercept=101377521)+
  geom_hline(yintercept=101294378)+
  geom_hline(yintercept=101257987)+
  geom_hline(yintercept=101227827)+
  geom_hline(yintercept=101047557)+
  geom_hline(yintercept=100762655)+
  geom_hline(yintercept=100447696, col="red")

Aug<-subset(fish3, month==8)
ggplot(Mar, aes(day, volume, group = year, color = year)) + 
  geom_line( )+
  labs(title="August Time Series of Lake Volume", 
       y="Volume m^3",
       x="Day of Month"
  ) +0
                      
  ylim(99000000, 103500000)+
  geom_hline(yintercept=101976479)+
  geom_hline(yintercept=101703873)+
  geom_hline(yintercept=101514389)+
  geom_hline(yintercept=101377521)+
  geom_hline(yintercept=101294378)+
  geom_hline(yintercept=101257987)+
  geom_hline(yintercept=101227827)+
  geom_hline(yintercept=101047557)+
  geom_hline(yintercept=100762655)+
  geom_hline(yintercept=100447696, col="red")

Sep<-subset(fish3, month==9)
ggplot(Sep, aes(day, volume, group = year, color = year)) + 
  geom_line( )+
  labs(title="September Time Series of Lake Volume", 
       y="Volume m^3",
       x="Day of Month"
  ) +
  ylim(99000000, 103500000)+
  geom_hline(yintercept=101976479)+
  geom_hline(yintercept=101703873)+
  geom_hline(yintercept=101514389)+
  geom_hline(yintercept=101377521)+
  geom_hline(yintercept=101294378)+
  geom_hline(yintercept=101257987)+
  geom_hline(yintercept=101227827)+
  geom_hline(yintercept=101047557)+
  geom_hline(yintercept=100762655)+
  geom_hline(yintercept=100447696, col="red")

Oct<-subset(fish3, month==10)
ggplot(Oct, aes(day, volume, group = year, color = year)) + 
  geom_line( )+
  labs(title="October Time Series of Lake Volume", 
       y="Volume m^3",
       x="Day of Month"
  ) +
  ylim(99000000, 103500000)+
  geom_hline(yintercept=101976479)+
  geom_hline(yintercept=101703873)+
  geom_hline(yintercept=101514389)+
  geom_hline(yintercept=101377521)+
  geom_hline(yintercept=101294378)+
  geom_hline(yintercept=101257987)+
  geom_hline(yintercept=101227827)+
  geom_hline(yintercept=101047557)+
  geom_hline(yintercept=100762655)+
  geom_hline(yintercept=100447696, col="red")

Nov<-subset(fish3, month==11)
ggplot(Nov, aes(day, volume, group = year, color = year)) + 
  geom_line( )+
  labs(title="November Time Series of Lake Volume", 
       y="Volume m^3",
       x="Day of Month"
  ) +
  ylim(99000000, 103500000)+
  geom_hline(yintercept=101976479)+
  geom_hline(yintercept=101703873)+
  geom_hline(yintercept=101514389)+
  geom_hline(yintercept=101377521)+
  geom_hline(yintercept=101294378)+
  geom_hline(yintercept=101257987)+
  geom_hline(yintercept=101227827)+
  geom_hline(yintercept=101047557)+
  geom_hline(yintercept=100762655)+
  geom_hline(yintercept=100447696, col="red")

Dec<-subset(fish3, month==12)
ggplot(Dec, aes(day, volume, group = year, color = year)) + 
  geom_line( )+
  labs(title="December Time Series of Lake Volume", 
       y="Volume m^3",
       x="Day of Month"
  ) +
  ylim(99000000, 103500000)+
  geom_hline(yintercept=101976479)+
  geom_hline(yintercept=101703873)+
  geom_hline(yintercept=101514389)+
  geom_hline(yintercept=101377521)+
  geom_hline(yintercept=101294378)+
  geom_hline(yintercept=101257987)+
  geom_hline(yintercept=101227827)+
  geom_hline(yintercept=101047557)+
  geom_hline(yintercept=100762655)+
  geom_hline(yintercept=100447696, col="red")



```
## Linking Objectives to Lake Level Elevation

Bathymetric data for Bluff Lake was collected in the winter of 2019 and 2020. Transect data was extrapolated to the whole reservoir and converted to a point layer of elevations in Arc GIS. In this section we link different WCS board heights and corresponding water surface elevation to metrics associated with refuge objectives. NNWR objectives for waterfowl, waterbirds, fish, and anglers can be linked to water surface elevation. Metrics for waterfowl and waterbirds assigned within the CCP describe optimal quantities of exposed shoreline and associated depths. However, metrics for fish and anglers were not directly assigned. In this section we used hectares >1m as available fish habitat, shoreline areas >1m of depth as fishable for bank anglers, and boat ramp area >0.5m as a representation of boat angler access. Board elevations were supplied by the USFWS. First, all the points in the bathymetric data greater or less than the metric criteria are selected. Then the slected points are multiplied by the area surrounding each point to yeild the associated number of hectares. Lastly, those metrics are converted to interpretable information. For example fish habitat was converted to water volume, and exposed lake area was converted to it's yeild of DEDs. Then metrics can be plotted against lake elevation and predictive models can be fit.




```{r Objectives.VS.Elevation, echo=FALSE}
dat <- read.csv("~/GitHub/Bluff-Lake-Project/_analysis/Depth-Mapping/_dat/Bathymetry/WCS_BTTMUP_2_2.csv")
# ---- Waterbirds
# areas must be less than 20 cm in depth
Z <- length(which(dat$POINT_Z > (66.45402-.20))) #add board hight and required depth
Z <- Z*1.56 #convert to area
B <- length(which(dat$POINT_Z > (66.45402+.22-.20))) #add board hight and required depth
B <- B*1.56 #convert to area
BB <- length(which(dat$POINT_Z > (66.45402+.44-.20))) #add board hight and required depth
BB <- BB*1.56 #convert to area
BBB <- length(which(dat$POINT_Z > (66.45402+.66-.20))) #add board hight and required depth
BBB <- BBB*1.56 #convert to area
BBBB <- length(which(dat$POINT_Z > (66.45402+.88-.20))) #add board hight and required depth
BBBB <- BBBB*1.56 #convert to area
BBBBB <- length(which(dat$POINT_Z > (66.45402+1.1-.20))) #add board hight and required depth
BBBBB <- BBBBB*1.56 #convert to area
BBBBBB <- length(which(dat$POINT_Z > (66.45402+1.32-.20))) #add board hight and required depth
BBBBBB <- BBBBBB*1.56 #convert to area
BBBBBBB <- length(which(dat$POINT_Z > (66.45402+1.54-.20))) #add board hight and required depth
BBBBBBB <- BBBBBBB*1.56 #convert to area
BBBBBBBB <- length(which(dat$POINT_Z > (66.45402+1.76-.20))) #add board hight and required depth
BBBBBBBB <- BBBBBBBB*1.56 #convert to area
BBBBBBBBB <- length(which(dat$POINT_Z > (66.45402+1.98-.20))) #add board hight and required depth
BBBBBBBBB <- BBBBBBBBB*1.56 #convert to area
elevation <- c(66.45402, 66.67402, 66.89402, 67.11402, 67.33402,
               67.55402, 67.77402, 67.99402, 68.21402, 68.43402)
WB <- c(Z, B, BB, BBB, BBBB, BBBBB, BBBBBB, BBBBBBB, BBBBBBBB, BBBBBBBBB)/10000
plot(elevation, WB, xlab="Water Surface Elevation", ylab="Hectares (<20cm)", main = "Waterbird Habitat", type="l", col="red")

# ---- Waterfowl
# DED/m^2=0.4374
# Dry Areas
Z <- sum(dat$POINT_Z > (66.45402)) #add board hight and required depth
Z <- Z*1.56*0.4374 #convert to DED per area
B <- sum(dat$POINT_Z > (66.45402+.22)) #add board hight and required depth
B <- B*1.56*0.4374
BB <- sum(dat$POINT_Z > (66.45402+.44)) #add board hight and required depth
BB <- BB*1.56*0.4374
BBB <- sum(dat$POINT_Z > (66.45402+.66)) #add board hight and required depth
BBB <- BBB*1.56*0.4374
BBBB <- sum(dat$POINT_Z > (66.45402+.88)) #add board hight and required depth
BBBB <- BBBB*1.56*0.4374
BBBBB <- sum(dat$POINT_Z > (66.45402+1.1)) #add board hight and required depth
BBBBB <- BBBBB*1.56*0.4374
BBBBBB <- sum(dat$POINT_Z > (66.45402+1.32)) #add board hight and required depth
BBBBBB <- BBBBBB*1.56*0.4374
BBBBBBB <- sum(dat$POINT_Z > (66.45402+1.54)) #add board hight and required depth
BBBBBBB <- BBBBBBB*1.56*0.4374
BBBBBBBB <- sum(dat$POINT_Z > (66.45402+1.76)) #add board hight and required depth
BBBBBBBB <- BBBBBBBB*1.56*0.4374
BBBBBBBBB <- sum(dat$POINT_Z > (66.45402+1.98)) #add board hight and required depth
BBBBBBBBB <- BBBBBBBBB*1.56*0.4374
elevation <- c(66.45402, 66.67402, 66.89402, 67.11402, 67.33402,
               67.55402, 67.77402, 67.99402, 68.21402, 68.43402)
WF <- c(Z, B, BB, BBB, BBBB, BBBBB, BBBBBB, BBBBBBB, BBBBBBBB, BBBBBBBBB)/1000000
plot(elevation, WF, xlab="Water Surface Elevation", ylab="DEDs (millions)", main = "Duck Energy Days", type="l", col="red")

# ---- Fish
# Areas greater than 1 meter in depth
Z <- sum(dat$POINT_Z < (66.45402-1)) #add board hight and required depth
Z <- Z*1.56 #convert to area
B <- sum(dat$POINT_Z < (66.45402-1+.22)) #add board hight and required depth
B <- B*1.56 #convert to area
BB <- sum(dat$POINT_Z < (66.45402-1+.44)) #add board hight and required depth
BB <- BB*1.56 #convert to area
BBB <- sum(dat$POINT_Z < (66.45402-1+.66)) #add board hight and required depth
BBB <- BBB*1.56 #convert to area
BBBB <- sum(dat$POINT_Z < (66.45402-1+.88)) #add board hight and required depth
BBBB <- BBBB*1.56 #convert to area
BBBBB <- sum(dat$POINT_Z < (66.45402-1+1.1)) #add board hight and required depth
BBBBB <- BBBBB*1.56 #convert to area
BBBBBB <- sum(dat$POINT_Z < (66.45402-1+1.32)) #add board hight and required depth
BBBBBB <- BBBBBB*1.56 #convert to area
BBBBBBB <- sum(dat$POINT_Z < (66.45402-1+1.54)) #add board hight and required depth
BBBBBBB <- BBBBBBB*1.56 #convert to area
BBBBBBBB <- sum(dat$POINT_Z < (66.45402-1+1.76)) #add board hight and required depth
BBBBBBBB <- BBBBBBBB*1.56 #convert to area
BBBBBBBBB <- sum(dat$POINT_Z < (66.45402-1+1.98)) #add board hight and required depth
BBBBBBBBB <- BBBBBBBBB*1.56 #convert to area
elevation <- c(66.45402, 66.67402, 66.89402, 67.11402, 67.33402,
               67.55402, 67.77402, 67.99402, 68.21402, 68.43402)
Fish <- c(Z, B, BB, BBB, BBBB, BBBBB, BBBBBB, BBBBBBB, BBBBBBBB, BBBBBBBBB)/10000
plot(elevation, Fish, xlab="Water Surface Elevation", ylab="Hectares (>1m)", main = "Fish Habitat", type="l", col="red")

#### ---- Anglers
# For now, following fish model, Areas greater than 1 meter in depth
Adat<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/Depth-Mapping/_dat/Bathymetry/Anglers.csv")
Z <- sum(Adat$POINT_Z < (66.45402-1)) #add board hight and required depth
Z <- Z*1.56 #convert to area
B <- sum(Adat$POINT_Z < (66.45402-1+.22)) #add board hight and required depth
B <- B*1.56 #convert to area
BB <- sum(Adat$POINT_Z < (66.45402-1+.44)) #add board hight and required depth
BB <- BB*1.56 #convert to area
BBB <- sum(Adat$POINT_Z < (66.45402-1+.66)) #add board hight and required depth
BBB <- BBB*1.56 #convert to area
BBBB <- sum(Adat$POINT_Z < (66.45402-1+.88)) #add board hight and required depth
BBBB <- BBBB*1.56 #convert to area
BBBBB <- sum(Adat$POINT_Z < (66.45402-1+1.1)) #add board hight and required depth
BBBBB <- BBBBB*1.56 #convert to area
BBBBBB <- sum(Adat$POINT_Z < (66.45402-1+1.32)) #add board hight and required depth
BBBBBB <- BBBBBB*1.56 #convert to area
BBBBBBB <- sum(Adat$POINT_Z < (66.45402-1+1.54)) #add board hight and required depth
BBBBBBB <- BBBBBBB*1.56 #convert to area
BBBBBBBB <- sum(Adat$POINT_Z < (66.45402-1+1.76)) #add board hight and required depth
BBBBBBBB <- BBBBBBBB*1.56 #convert to area
BBBBBBBBB <- sum(Adat$POINT_Z < (66.45402-1+1.98)) #add board hight and required depth
BBBBBBBBB <- BBBBBBBBB*1.56 #convert to area
elevation <- c(66.45402, 66.67402, 66.89402, 67.11402, 67.33402,
               67.55402, 67.77402, 67.99402, 68.21402, 68.43402)
Anglers <- c(Z, B, BB, BBB, BBBB, BBBBB, BBBBBB, BBBBBBB, BBBBBBBB, BBBBBBBBB)/10000
plot(elevation, Anglers, xlab="Water Surface Elevation", ylab="Hectares (>1m)", main = "Shoreline Fishing", type="l", col="red")

# Need to deliniate shorelines and establish "end" of boat ramp
#areas >.5m in depth
Bdat<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/Depth-Mapping/_dat/Bathymetry/Boat.csv")
Z <- sum(Bdat$POINT_Z < (66.45402)) #add board hight and required depth
Z <- Z*1.56 #convert to area
B <- sum(Bdat$POINT_Z < (66.45402+.22-0.5)) #add board hight and required depth
B <- B*1.56 #convert to area
BB <- sum(Bdat$POINT_Z < (66.45402+.44-0.5)) #add board hight and required depth
BB <- BB*1.56 #convert to area
BBB <- sum(Bdat$POINT_Z < (66.45402+.66-0.5)) #add board hight and required depth
BBB <- BBB*1.56 #convert to area
BBBB <- sum(Bdat$POINT_Z < (66.45402+.88-0.5)) #add board hight and required depth
BBBB <- BBBB*1.56 #convert to area
BBBBB <- sum(Bdat$POINT_Z < (66.45402+1.1-0.5)) #add board hight and required depth
BBBBB <- BBBBB*1.56 #convert to area
BBBBBB <- sum(Bdat$POINT_Z < (66.45402+1.32-0.5)) #add board hight and required depth
BBBBBB <- BBBBBB*1.56 #convert to area
BBBBBBB <- sum(Bdat$POINT_Z < (66.45402+1.54-0.5)) #add board hight and required depth
BBBBBBB <- BBBBBBB*1.56 #convert to area
BBBBBBBB <- sum(Bdat$POINT_Z < (66.45402+1.76-0.5)) #add board hight and required depth
BBBBBBBB <- BBBBBBBB*1.56 #convert to area
BBBBBBBBB <- sum(Bdat$POINT_Z < (66.45402+1.98-0.5)) #add board hight and required depth
BBBBBBBBB <- BBBBBBBBB*1.56 #convert to area
elevation <- c(66.45402, 66.67402, 66.89402, 67.11402, 67.33402,
               67.55402, 67.77402, 67.99402, 68.21402, 68.43402)
Ramp <- c(Z, B, BB, BBB, BBBB, BBBBB, BBBBBB, BBBBBBB, BBBBBBBB, BBBBBBBBB)
plot(elevation, Ramp, xlab="Water Surface Elevation", ylab="Wetted Area (m^2)", main = "Ramp Access", type="l", col="red")


```
## Scaling Metrics

Objective metrics are then scaled 0-1.

```{r Utilities, echo=FALSE}
WB<- rescale(WB, to=c(0,1))
plot(elevation, WB, xlab="Water Surface Elevation", ylab="Utility", main = "Waterbird Habitat", type="l", col="red")
WBM <- gam(WB ~ s(elevation, bs = "cr"),
             family = gaussian)
par(new=T)
plot(WBM$fitted.values~elevation, col="blue", type="l", xlab=NA, ylab=NA)
WF<-rescale(WF, to=c(0,1))
plot(elevation, WF, xlab="Water Surface Elevation", ylab="Utility", main = "Duck Energy Days", type="l", col="red")
WFM <- gam(WF ~ s(elevation, bs = "cr"),
             family = gaussian)
par(new=T)
plot(WFM$fitted.values~elevation, col="blue", type="l", xlab=NA, ylab=NA)
Fish <-rescale(Fish, to=c(0,1))
plot(elevation, Fish, xlab="Water Surface Elevation", ylab="Utility", main = "Fish Habitat", type="l", col="red")
FishM <- gam(Fish ~ s(elevation, bs = "cr"),
             family = gaussian)
par(new=T)
plot(FishM$fitted.values~elevation, col="blue", type="l", xlab=NA, ylab=NA)
Anglers<-rescale(Anglers, to=c(0,1))
plot(elevation, Anglers, xlab="Water Surface Elevation", ylab="Utility", main = "Shoreline Fishing", type="l", col="red")
AnglersM <- gam(Anglers ~ s(elevation, bs = "cr"),
             family = gaussian)
par(new=T)
plot(AnglersM$fitted.values~elevation, col="blue", type="l", xlab=NA, ylab=NA)
Ramp<-rescale(Ramp, to=c(0,1))
plot(elevation, Ramp, xlab="Water Surface Elevation", ylab="Utility", main = "Ramp Access", type="l", col="red")
RampM <- gam(Ramp ~ s(elevation, bs = "cr"),
                family = gaussian)
par(new=T)
plot(RampM$fitted.values~elevation, col="blue", type="l", xlab=NA, ylab=NA)
```


```{r Assigning Utilities, echo=FALSE}
Zero<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_0cms_discharge/0Boards.csv")
Zero$Board<- rep("0B",nrow(Zero))
One<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_0cms_discharge/1Boards.csv")
One$Board<- rep("1B",nrow(One))
Two<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_0cms_discharge/2Boards.csv")
Two$Board<- rep("2B",nrow(Two))
Three<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_0cms_discharge/3Boards.csv")
Three$Board<- rep("3B",nrow(Three))
Four<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_0cms_discharge/4Boards.csv")
Four$Board<- rep("4b",nrow(Four))
Five<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_0cms_discharge/5Boards.csv")
Five$Board<- rep("5B",nrow(Five))
Six<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_0cms_discharge/6Boards.csv")
Six$Board<- rep("6B",nrow(Six))
Seven<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_0cms_discharge/7Boards.csv")
Seven$Board<- rep("7B",nrow(Seven))
Eight<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_0cms_discharge/8Boards.csv")
Eight$Board<- rep("8B",nrow(Eight))
Nine<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_0cms_discharge/9Boards.csv")
Nine$Board<- rep("9B",nrow(Nine))
Zero <- rbind(Zero, One, Two, Three, Four, Five, Six, Seven, Eight, Nine)
write.csv(Zero, "~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_0cms_discharge/AllBoards.csv")

Zero<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_2.825cms_discharge/0Boards.csv")
Zero$Board<- rep("0B",nrow(Zero))
One<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_2.825cms_discharge/1Boards.csv")
One$Board<- rep("1B",nrow(One))
Two<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_2.825cms_discharge/2Boards.csv")
Two$Board<- rep("2B",nrow(Two))
Three<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_2.825cms_discharge/3Boards.csv")
Three$Board<- rep("3B",nrow(Three))
Four<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_2.825cms_discharge/4Boards.csv")
Four$Board<- rep("4b",nrow(Four))
Five<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_2.825cms_discharge/5Boards.csv")
Five$Board<- rep("5B",nrow(Five))
Six<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_2.825cms_discharge/6Boards.csv")
Six$Board<- rep("6B",nrow(Six))
Seven<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_2.825cms_discharge/7Boards.csv")
Seven$Board<- rep("7B",nrow(Seven))
Eight<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_2.825cms_discharge/8Boards.csv")
Eight$Board<- rep("8B",nrow(Eight))
Nine<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_2.825cms_discharge/9Boards.csv")
Nine$Board<- rep("9B",nrow(Nine))
One <- rbind(Zero, One, Two, Three, Four, Five, Six, Seven, Eight, Nine)
write.csv(One, "~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_2.825cms_discharge/AllBoards.csv")

Zero<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_5.65cms_discharge/0Boards.csv")
Zero$Board<- rep("0B",nrow(Zero))
One<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_5.65cms_discharge/1Boards.csv")
One$Board<- rep("1B",nrow(One))
Two<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_5.65cms_discharge/2Boards.csv")
Two$Board<- rep("2B",nrow(Two))
Three<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_5.65cms_discharge/3Boards.csv")
Three$Board<- rep("3B",nrow(Three))
Four<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_5.65cms_discharge/4Boards.csv")
Four$Board<- rep("4b",nrow(Four))
Five<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_5.65cms_discharge/5Boards.csv")
Five$Board<- rep("5B",nrow(Five))
Six<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_5.65cms_discharge/6Boards.csv")
Six$Board<- rep("6B",nrow(Six))
Seven<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_5.65cms_discharge/7Boards.csv")
Seven$Board<- rep("7B",nrow(Seven))
Eight<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_5.65cms_discharge/8Boards.csv")
Eight$Board<- rep("8B",nrow(Eight))
Nine<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_5.65cms_discharge/9Boards.csv")
Nine$Board<- rep("9B",nrow(Nine))
Two <- rbind(Zero, One, Two, Three, Four, Five, Six, Seven, Eight, Nine)
write.csv(Two, "~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_5.65cms_discharge/AllBoards.csv")

Zero<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_8.475cms_discharge/0Boards.csv")
Zero$Board<- rep("0B",nrow(Zero))
One<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_8.475cms_discharge/1Boards.csv")
One$Board<- rep("1B",nrow(One))
Two<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_8.475cms_discharge/2Boards.csv")
Two$Board<- rep("2B",nrow(Two))
Three<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_8.475cms_discharge/3Boards.csv")
Three$Board<- rep("3B",nrow(Three))
Four<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_8.475cms_discharge/4Boards.csv")
Four$Board<- rep("4b",nrow(Four))
Five<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_8.475cms_discharge/5Boards.csv")
Five$Board<- rep("5B",nrow(Five))
Six<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_8.475cms_discharge/6Boards.csv")
Six$Board<- rep("6B",nrow(Six))
Seven<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_8.475cms_discharge/7Boards.csv")
Seven$Board<- rep("7B",nrow(Seven))
Eight<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_8.475cms_discharge/8Boards.csv")
Eight$Board<- rep("8B",nrow(Eight))
Nine<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_8.475cms_discharge/9Boards.csv")
Nine$Board<- rep("9B",nrow(Nine))
Three <- rbind(Zero, One, Two, Three, Four, Five, Six, Seven, Eight, Nine)
write.csv(Three, "~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_8.475cms_discharge/AllBoards.csv")


Zero<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_11.3cms_discharge/0Boards.csv")
Zero$Board<- rep("0B",nrow(Zero))
One<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_11.3cms_discharge/1Boards.csv")
One$Board<- rep("1B",nrow(One))
Two<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_11.3cms_discharge/2Boards.csv")
Two$Board<- rep("2B",nrow(Two))
Three<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_11.3cms_discharge/3Boards.csv")
Three$Board<- rep("3B",nrow(Three))
Four<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_11.3cms_discharge/4Boards.csv")
Four$Board<- rep("4b",nrow(Four))
Five<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_11.3cms_discharge/5Boards.csv")
Five$Board<- rep("5B",nrow(Five))
Six<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_11.3cms_discharge/6Boards.csv")
Six$Board<- rep("6B",nrow(Six))
Seven<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_11.3cms_discharge/7Boards.csv")
Seven$Board<- rep("7B",nrow(Seven))
Eight<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_11.3cms_discharge/8Boards.csv")
Eight$Board<- rep("8B",nrow(Eight))
Nine<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_11.3cms_discharge/9Boards.csv")
Nine$Board<- rep("9B",nrow(Nine))
Four <- rbind(Zero, One, Two, Three, Four, Five, Six, Seven, Eight, Nine)
write.csv(Four, "~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_11.3cms_discharge/AllBoards.csv")


Zero<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_14.125cms_discharge/0Boards.csv")
Zero$Board<- rep("0B",nrow(Zero))
One<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_14.125cms_discharge/1Boards.csv")
One$Board<- rep("1B",nrow(One))
Two<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_14.125cms_discharge/2Boards.csv")
Two$Board<- rep("2B",nrow(Two))
Three<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_14.125cms_discharge/3Boards.csv")
Three$Board<- rep("3B",nrow(Three))
Four<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_14.125cms_discharge/4Boards.csv")
Four$Board<- rep("4b",nrow(Four))
Five<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_14.125cms_discharge/5Boards.csv")
Five$Board<- rep("5B",nrow(Five))
Six<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_14.125cms_discharge/6Boards.csv")
Six$Board<- rep("6B",nrow(Six))
Seven<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_14.125cms_discharge/7Boards.csv")
Seven$Board<- rep("7B",nrow(Seven))
Eight<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_14.125cms_discharge/8Boards.csv")
Eight$Board<- rep("8B",nrow(Eight))
Nine<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_14.125cms_discharge/9Boards.csv")
Nine$Board<- rep("9B",nrow(Nine))
Five <- rbind(Zero, One, Two, Three, Four, Five, Six, Seven, Eight, Nine)
write.csv(Five, "~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_14.125cms_discharge/AllBoards.csv")


Zero<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_16.95cms_discharge/0Boards.csv")
Zero$Board<- rep("0B",nrow(Zero))
One<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_16.95cms_discharge/1Boards.csv")
One$Board<- rep("1B",nrow(One))
Two<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_16.95cms_discharge/2Boards.csv")
Two$Board<- rep("2B",nrow(Two))
Three<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_16.95cms_discharge/3Boards.csv")
Three$Board<- rep("3B",nrow(Three))
Four<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_16.95cms_discharge/4Boards.csv")
Four$Board<- rep("4b",nrow(Four))
Five<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_16.95cms_discharge/5Boards.csv")
Five$Board<- rep("5B",nrow(Five))
Six<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_16.95cms_discharge/6Boards.csv")
Six$Board<- rep("6B",nrow(Six))
Seven<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_16.95cms_discharge/7Boards.csv")
Seven$Board<- rep("7B",nrow(Seven))
Eight<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_16.95cms_discharge/8Boards.csv")
Eight$Board<- rep("8B",nrow(Eight))
Nine<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_16.95cms_discharge/9Boards.csv")
Nine$Board<- rep("9B",nrow(Nine))
Six <- rbind(Zero, One, Two, Three, Four, Five, Six, Seven, Eight, Nine)
write.csv(Six, "~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_16.95cms_discharge/AllBoards.csv")

Zero<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_0cms_discharge/AllBoards.csv")
Zero$Discharge<- rep("0 cms",nrow(Zero))
One<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_2.825cms_discharge/AllBoards.csv")
One$Discharge<- rep("2.825 cms",nrow(One))
Two<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_5.65cms_discharge/AllBoards.csv")
Two$Discharge<- rep("5.65 cms",nrow(Two))
Three<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_8.475cms_discharge/AllBoards.csv")
Three$Discharge<- rep("8.475 cms",nrow(Three))
Four<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_11.3cms_discharge/AllBoards.csv")
Four$Discharge<- rep("11.3 cms",nrow(Four))
Five<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_14.125cms_discharge/AllBoards.csv")
Five$Discharge<- rep("14.125 cms",nrow(Five))
Six<-read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_16.95cms_discharge/AllBoards.csv")
Six$Discharge<- rep("16.95 cms",nrow(Six))
Six <- rbind(Zero, One, Two, Three, Four, Five, Six)
write.csv(Six, "~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/AllBoardsAllDischarge.csv")
```
##Forming Utilities 

Here we combine the outputf from the preceeding three sections to form utilities. First we take our simulated lake levels for our data range (1945-2020), and assign daily utilities for each objective given water surface elevation. We then add these utilities together to form the total daily utility (objectives were unweighted).These total daily utilities were then averaged across years to account for annual variability.

#This code should be re-run for each elevation/discharge combo, and for variable weighting strategies.

```{r Assigning Utilities, echo=FALSE}
#Utilities
dat2<- read.csv("~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/AllBoardsAllDischarge.csv")


dat2$elevation<-predict(gam_2, dat2)
dat2$WFUt<-predict(WFM, dat2)
dat2$WBUt<-predict(WBM, dat2)
dat2$FishUt<-predict(FishM, dat2)
dat2$AngUt<-predict(AnglersM, dat2)
dat2$RampUt<-predict(RampM, dat2)

dat2$WFUt <- ifelse(dat2$WFUt< 0, 0, dat2$WFUt)
dat2$WBUt<- ifelse(dat2$WBUt < 0, 0, dat2$WBUt)
dat2$FishUt <- ifelse(dat2$FishUt  < 0, 0, dat2$FishUt)
dat2$AngUt <- ifelse(dat2$AngUt < 0, 0, dat2$AngUt)
dat2$RampUt <- ifelse(dat2$RampUt < 0, 0, dat2$RampUt)
dat2$WFUt <- ifelse(dat2$WFUt > 1, 1, dat2$WFUt)
dat2$WBUt<- ifelse(dat2$WBUt > 1, 1, dat2$WBUt)
dat2$FishUt <- ifelse(dat2$FishUt  > 1, 1, dat2$FishUt)
dat2$AngUt <- ifelse(dat2$AngUt > 1, 1, dat2$AngUt)
dat2$RampUt <- ifelse(dat2$RampUt > 1, 1, dat2$RampUt)
W<- c(.25,.25,.25,.25)
dat2$Utility<-(W[1]*((dat2$RampUt*.5) + (dat2$AngUt*.5))) + (W[2]*dat2$FishUt) + (W[3]*dat2$WBUt) + (W[4]*dat2$WFUt)

#write.csv(dat2, "~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/weekly_0cms_discharge/9Boards.csv")


#weekly average
dat2<-dat2 %>%
  filter(!is.na(Utility))
dat2$Date <- as.POSIXct(dat2$Date, format="%m-%d-%Y")
# dat2 <- dat2 %>%
#   dplyr::group_by(Date) %>%
#   dplyr::summarize(mUtility = sum(Utility, na.rm = T),
#             mWFUt = sum(WFUt, na.rm = T),
#             mWBUt= sum(WBUt, na.rm = T),
#             mFishUt = sum(FishUt, na.rm = T),
#             mAngUt = sum(AngUt, na.rm = T),
#             mRampUt = sum(RampUt, na.rm = T))

# dat2$month<-lubridate::month(dat2$Date)
# dat2$day<-lubridate::day(dat2$Date)
# dat2$month_day<-paste(dat2$month,dat2$day,sep="-")
# dat2<-dat2 %>%
#   dplyr::group_by(Discharge, Board, Date, month, day) %>%
#   dplyr::summarize(mUtility = mean(mUtility, na.rm = T),
#             mWFUt = mean(mWFUt, na.rm = T),
#             mWBUt= mean(mWBUt, na.rm = T),
#             mFishUt = mean(mFishUt, na.rm = T),
#             mAngUt = mean(mAngUt, na.rm = T),
#             mRampUt = mean(mRampUt, na.rm = T))
dat2$value <- paste(dat2$Board, dat2$Discharge, dat2$year, sep="_")
dat2 <-dat2 %>%  dplyr::group_by(year, month, value)  %>%  
  dplyr::mutate(CumUt = cumsum(Utility))
write.csv(dat2, "~/GitHub/Bluff-Lake-Project/_analysis/noxubee-discharge-states/paddlefish-discharges/AllUtilities.csv")

dat<-subset(dat2, Board=="5B")
dat<-subset(dat, month==1)
ggplot(dat, aes(day, CumUt, group = value, color = Discharge)) +
  geom_line()+
  labs(title="Utility of Paddlefish Discharges-5 Board-January",
       y="Utility",
       x="Day of Month")+
  scale_colour_discrete(
            breaks=c("0 cms", "2.825 cms", "5.65 cms", "8.475 cms", "11.3 cms", 
                     "14.125 cms", "16.95 cms"),
            labels=c("0", "2.825", "5.65", "8.475", "11.3", "14.125", "16.95"))+
  facet_wrap(~ month)



```


## Monthly Plots

Utlilities given variable water level management or vairable padddlefish discharges can then be plotted by month. The optimal management strategey can then be selected.

```{r Monthly Plots, echo=FALSE}

dat<-subset(dat2, Board=="1B")
#dat<-subset(dat, month==3)
ggplot(dat, aes(day, CumUt, group = value, color = Discharge)) +
  geom_line()+
  labs(title="Utility of Paddlefish Discharges 1 Board by month",
       y="Utility",
       x="Day of Month")+
  scale_colour_discrete(
            breaks=c("0 cms", "2.825 cms", "5.65 cms", "8.475 cms", "11.3 cms", 
                     "14.125 cms", "16.95 cms"),
            labels=c("0", "2.825", "5.65", "8.475", "11.3", "14.125", "16.95"))+
  facet_wrap(~ month)

dat<-subset(dat2, Board=="5B")
#dat<-subset(dat, month==3)
ggplot(dat, aes(day, CumUt, group = value, color = Discharge)) +
  geom_line()+
  labs(title="Utility of Paddlefish Discharges 5 Board by month",
       y="Utility",
       x="Day of Month")+
  scale_colour_discrete(
            breaks=c("0 cms", "2.825 cms", "5.65 cms", "8.475 cms", "11.3 cms", 
                     "14.125 cms", "16.95 cms"),
            labels=c("0", "2.825", "5.65", "8.475", "11.3", "14.125", "16.95"))+
  facet_wrap(~ month)

dat<-subset(dat2, Board=="9B")
#dat<-subset(dat, month==3)
ggplot(dat, aes(day, CumUt, group = value, color = Discharge)) +
  geom_line()+
  labs(title="Utility of Paddlefish Discharges 9 Board by month",
       y="Utility",
       x="Day of Month")+
  scale_colour_discrete(
            breaks=c("0 cms", "2.825 cms", "5.65 cms", "8.475 cms", "11.3 cms", 
                     "14.125 cms", "16.95 cms"),
            labels=c("0", "2.825", "5.65", "8.475", "11.3", "14.125", "16.95"))+
  facet_wrap(~ month)
```